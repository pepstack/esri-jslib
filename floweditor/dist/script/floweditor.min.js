/******************************************************************************
 * floweditor.js
 *
 * Version: 0.0.1pre
 *
 * Copyright (c) 2011-2012 Esri
 *
 * All rights reserved under the copyright laws of the United States.
 * You may freely redistribute and use this software, with or
 * without modification, provided you include the original copyright
 * and use restrictions.  See use restrictions in the file:
 * <install location>/License.txt
 *
 * Last Date: 
 *****************************************************************************//**
 * floweditor.js
 *   required: esri2.utility.js
 */
(function(a,b){__using_script(__get_script_path(a)+b)})("/floweditor.js","esri2.geoflow.js");var GeoFlowEditor=function(a,b,c){function A(a,b){a.bkgndImage=b.getImageState(esri2.GeoFlow.NodeTypes.BkgndGrid);var c=a.addWidget("esri_logo");c.setImage(b.getImageState("esri_logo"),65,36,"right-bottom"),c.visible=!1;var e=a.addWidget("status_legend");e.setImage(b.getImageState("status_legend"),144,143,"left-top"),e.visible=!1,a.resizeMap(i.offsetWidth,i.offsetHeight),d.flowChart.init(a,b),a.onKeyPressed=function(a,b){var c=String.fromCharCode(a.keyCode);__log(c)},a.onMouseDown=function(a,b){d.getMousePos(a),d.flowChart.invokeEventHandler(a,b)},a.onMouseUp=function(a,b){d.getMousePos(a),d.flowChart.invokeEventHandler(a,b)},a.onMouseMove=function(a,b){d.getMousePos(a),z(a),d.flowChart.invokeEventHandler(a,b)},a.onMouseOver=function(a,b){d.getMousePos(a),d.flowChart.invokeEventHandler(a,b)},a.onMouseOut=function(a,b){d.getMousePos(a),d.flowChart.invokeEventHandler(a,b)},a.onMouseClick=function(a,b){d.getMousePos(a),d.flowChart.invokeEventHandler(a,b)};var f=a.canvas;__add_event(f,"dragover",function(a){a.preventDefault&&a.preventDefault(),a.dataTransfer.dropEffect="copy";return!1}),__add_event(f,"drop",function(a){a.stopPropagation&&a.stopPropagation(),d.getMousePos(a);var b=d.flowChart.createNode(null,a.dataTransfer.getData("Text"),a._x,a._y);__not_null(b)&&d.refresh()})}function z(a){if(h){n&&o&&(n.value=a._x,o.value=a._y);if(r&&s){var b=h.toMapPoint(a._x,a._y);r.value=b.x,s.value=b.y}}}function y(a){return __browser.firefox&&a.layerY?a.layerY-k:a.offsetY}function x(a){return __browser.firefox&&a.layerX?a.layerX-j:a.offsetX}"use strict";var d=this,e=a,f=b,g=!1,h=null,i=null,j=0,k=0,l="@pos_x",m="@pos_y",n=null,o=null,p="_map_x",q="_map_y",r=null,s=null,t=null,u=null,v=null,w=null;this._imgPath=__get_script_path("/script/")+"img/",this.flowChart=new esri2.GeoFlow(this),this.showNodeDlg=c,this.nodeState=new esri2.GeoFlow.Node.EditState(null),this.readOnly=!1,this.getMousePos=function(a){g&&(j=i.offsetLeft,k=i.offsetTop),a._x=x(a),a._y=y(a)},this.setMousePosSink=function(a,b,c,d){l=a,m=b,p=c,q=d},this.setOnBeforeLoad=function(a,b){u=b,t=a},this.setOnAfterLoad=function(a,b){v=a,w=b},this.getMapCanvas=function(){return h},__add_event(window,"load",function(){__not_null(t)&&t(u),d.onLoad()}),this.onLoad=function(){i=__get_elem(f);if(__browser.firefox||__browser.chrome)i.style.position!="absolute"&&(g=!0);n=__get_elem(l),o=__get_elem(m),r=__get_elem(p),s=__get_elem(q),h=new esri2.Map(e),h.bkgndColor="#fff",h.resizeMap(i.offsetWidth,i.offsetHeight);var a=new esri2.Common.ImageLoader(function(b){b.loader.allReady()&&(__log("all images loaded successfully"),A(h,a),__not_null(v)&&(__log("GeoFlowEditor: __afterLoad"),v(w)))},null),b=esri2.GeoFlow.NodeTypes,c=this._imgPath;a.addImage("esri_logo",c+"esri_logo.png"),a.addImage("status_legend",c+"status_legend.png"),a.addImage(b.BkgndGrid,c+b.BkgndGrid+".png"),a.addImage(b.BkgndGrid+"_",c+b.BkgndGrid+"_.png"),a.addImage(b.LinkCutter,c+b.LinkCutter+".png"),a.addImage(b.NodeEditName,c+b.NodeEditName+".png"),a.addImage(b.NodeEditName+"_",c+b.NodeEditName+"_.png"),a.addImage(b.NodeDropName,c+b.NodeDropName+".png"),a.addImage(b.NodeDropName+"_",c+b.NodeDropName+"_.png"),c=this._imgPath+"node/",a.addImage(b.NodeAssignment,c+b.NodeAssignment+".png"),a.addImage(b.NodeAssignment+"_",c+b.NodeAssignment+"_.png"),a.addImage(b.NodeDispatch,c+b.NodeDispatch+".png"),a.addImage(b.NodeDispatch+"_",c+b.NodeDispatch+"_.png"),a.addImage(b.NodeGeometry,c+b.NodeGeometry+".png"),a.addImage(b.NodeGeometry+"_",c+b.NodeGeometry+"_.png"),a.addImage(b.NodeGpAsync,c+b.NodeGpAsync+".png"),a.addImage(b.NodeGpAsync+"_",c+b.NodeGpAsync+"_.png"),a.addImage(b.NodeGpSync,c+b.NodeGpSync+".png"),a.addImage(b.NodeGpSync+"_",c+b.NodeGpSync+"_.png"),a.addImage(b.NodeDefaultVal,c+b.NodeDefaultVal+".png"),a.addImage(b.NodeDefaultVal+"_",c+b.NodeDefaultVal+"_.png"),a.addImage(b.NodeFeature,c+b.NodeFeature+".png"),a.addImage(b.NodeFeature+"_",c+b.NodeFeature+"_.png"),a.addImage(b.NodePubInput,c+b.NodePubInput+".png"),a.addImage(b.NodePubInput+"_",c+b.NodePubInput+"_.png"),a.addImage(b.NodePubOutput,c+b.NodePubOutput+".png"),a.addImage(b.NodePubOutput+"_",c+b.NodePubOutput+"_.png"),c=this._imgPath+"port/",a.addImage(b.NodeInPort,c+b.NodeInPort+".png"),a.addImage(b.NodeInPort+"_",c+b.NodeInPort+"_.png"),a.addImage(b.NodeOutPort,c+b.NodeOutPort+".png"),a.addImage(b.NodeOutPort+"_",c+b.NodeOutPort+"_.png"),a.addImage(b.OutPortSel,c+b.OutPortSel+".png"),a.addImage(b.OutPortUnsel,c+b.OutPortUnsel+".png"),a.addImage(b.OutPortLinked,c+b.OutPortLinked+".png"),a.addImage(b.InPortSel,c+b.InPortSel+".png"),a.addImage(b.InPortUnsel,c+b.InPortUnsel+".png"),a.addImage(b.InPortLinked,c+b.InPortLinked+".png"),a.loadAll()},this.resizeCanvas=function(a,b){if(__not_null(h)&&__not_null(i)){var c=i.offsetWidth,d=i.offsetHeight;__not_null(a)&&__not_null(b)&&(c=a,d=b);if(c!==h.width||d!==h.height)__log("GeoFlowEditor.resizeCanvas: ",c,d),h.resizeMap(c,d),this.refresh()}}};GeoFlowEditor.prototype.updateAll=function(){this.flowChart.layerNode.updateBound(),this.flowChart.layerLink.updateBound(),this.flowChart.mapCanvas.refreshAll()},GeoFlowEditor.prototype.updateNode=function(a,b,c){if(__not_null(a)){__log("GeoFlowEditor.updateNode: ",a.toString(),c),this.nodeState.currentNode=a,this.nodeState.nodeJSON=b,this.nodeState.nodeURL=c;switch(a.getTypeName()){case esri2.GeoFlow.NodeTypes.NodeAssignment:GeoFlowEditor.updateNodeAssignment(a);break;case esri2.GeoFlow.NodeTypes.NodeDefaultVal:GeoFlowEditor.updateNodeDefaultVal(a);break;case esri2.GeoFlow.NodeTypes.NodePubOutput:GeoFlowEditor.updateNodePubOutput(a);break;case esri2.GeoFlow.NodeTypes.NodePubInput:GeoFlowEditor.updateNodePubInput(a);break;default:this.nodeState.update()}this.flowChart.mapCanvas.refreshAll()}else if(__not_null(b)){__log("GeoFlowEditor.updateNode: ",JSON.stringify(b));var d,e;for(d in b)e=b[d],this.flowChart.updateState(d,e);this.flowChart.mapCanvas.refreshAll()}},GeoFlowEditor.prototype.exportJSON=function(a){var b=this.flowChart.toJsonString(a);return b},GeoFlowEditor.prototype.importJSON=function(a){this.removeAll(),__not_null(a)&&this.flowChart.loadJSON(a),this.refresh()},GeoFlowEditor.prototype.validateFlow=function(){this.flowChart.validate()},GeoFlowEditor.prototype.enableWidget=function(a,b){var c=this.getMapCanvas();c.widgetItem(a).visible=b?!0:!1},GeoFlowEditor.prototype.refresh=function(){this.flowChart.mapCanvas.refreshAll()},GeoFlowEditor.prototype.removeAll=function(){this.flowChart.clear(),this.refresh()},GeoFlowEditor.prototype.getScaleFactor=function(){return this.flowChart.mapCanvas.scaleFactor},GeoFlowEditor.prototype.setScaleFactor=function(a){this.flowChart.mapCanvas.scaleFactor=a},GeoFlowEditor.prototype.createNodeList=function(a){var b,c,d,e,f,g,h=esri2.GeoFlow.NodeTypes.nodes,i=this._imgPath;__log("NOTE: see nodetypes.js to find Configuration for drawing geoflow node, link,...");while(a.firstChild)a.removeChild(a.firstChild);for(e in h)f=h[e],b=document.createElement("dt"),a.appendChild(b),c=document.createElement("a"),g=document.createElement("img"),__log("fill node list: ",f.nodeIcon),g.src=i+f.nodeIcon,d=document.createTextNode(e),c.appendChild(g),c.appendChild(d),c.href="#",this.setNodeDraggable(c,e),b.appendChild(c)},GeoFlowEditor.prototype.setNodeDraggable=function(a,b){a.setAttribute("draggable","true"),a.id=b,__add_event(a,"dragstart",function(a){a.dataTransfer.effectAllowed="copy",a.dataTransfer.setData("Text",this.id)})},GeoFlowEditor.prototype.initNodeDialog=function(a,b){a.init(this,b);switch(b.getTypeName()){case esri2.GeoFlow.NodeTypes.NodeGpSync:a.content=GeoFlowEditor.getGpSyncDlgContent(b);return!0;case esri2.GeoFlow.NodeTypes.NodeGpAsync:a.content=GeoFlowEditor.getGpAsyncDlgContent(b);return!0;case esri2.GeoFlow.NodeTypes.NodePubInput:a.content=GeoFlowEditor.getPubInputDlgContent(b),a.setButtons(1,0,0),a.width=400,a.height=300;return!0;case esri2.GeoFlow.NodeTypes.NodePubOutput:a.content=GeoFlowEditor.getPubOutputDlgContent(b),a.setButtons(1,1,0),a.width=400,a.height=300;return!0;case esri2.GeoFlow.NodeTypes.NodeGeometry:a.content=GeoFlowEditor.getGeometryDlgContent(b);return!0;case esri2.GeoFlow.NodeTypes.NodeFeature:a.content=GeoFlowEditor.getFeatureDlgContent(b);return!0;case esri2.GeoFlow.NodeTypes.NodeDefaultVal:a.content=GeoFlowEditor.getDefaultValDlgContent(b);return!0;case esri2.GeoFlow.NodeTypes.NodeDispatch:a.content=GeoFlowEditor.getDispatchDlgContent(b);return!0;case esri2.GeoFlow.NodeTypes.NodeAssignment:a.content=GeoFlowEditor.getAssignmentDlgContent(b);return!0}return!1},GeoFlowEditor.GPServicesList={GpSync:[{name:"Create Drive Time Polygons",url:"http://sampleserver1.arcgisonline.com/ArcGIS/rest/services/Network/ESRI_DriveTime_US/GPServer/CreateDriveTimePolygons"},{name:"Population Summary",url:"http://sampleserver1.arcgisonline.com/ArcGIS/rest/services/Demographics/ESRI_Population_World/GPServer/PopulationSummary"},{name:"Profile Service",url:"http://sampleserver2.arcgisonline.com/ArcGIS/rest/services/Elevation/ESRI_Elevation_World/GPServer/ProfileService"},{name:"Viewshed",url:"http://sampleserver1.arcgisonline.com/ArcGIS/rest/services/Elevation/ESRI_Elevation_World/GPServer/Viewshed"}],GpAsync:[{name:"ERG By Chemical",url:"http://sampleserver2.arcgisonline.com/ArcGIS/rest/services/PublicSafety/EMModels/GPServer/ERGByChemical"},{name:"ERG By Placard",url:"http://sampleserver2.arcgisonline.com/ArcGIS/rest/services/PublicSafety/EMModels/GPServer/ERGByPlacard"},{name:"Extract Data Task",url:"http://sampleserver4.arcgisonline.com/ArcGIS/rest/services/HomelandSecurity/Incident_Data_Extraction/GPServer/Extract%20Data%20Task"},{name:"Strip Map 3Sheet Profile",url:"http://sampleserver4.arcgisonline.com/ArcGIS/rest/services/Arcpy/ArcpyMapping/GPServer/StripMap3SheetProfile"}]},GeoFlowEditor.NodeDialogWidth=570,GeoFlowEditor.NodeDialogHeight=360,GeoFlowEditor.__divNodeState="__divNodeState",GeoFlowEditor.__serviceURLs="__serviceURLs",GeoFlowEditor.NodeDialogParam=function(a){this.dlgDIV=__get_elem(a),this.dlgSelector="#"+a,this.autoOpen=!0,this.content="",this.width=GeoFlowEditor.NodeDialogWidth,this.height=GeoFlowEditor.NodeDialogHeight,this.title="",this.buttons={}},GeoFlowEditor.NodeDialogParam.prototype.init=function(a,b){GeoFlowEditor.instance=a,this.autoOpen=!0,this.content="",this.width=GeoFlowEditor.NodeDialogWidth,this.height=GeoFlowEditor.NodeDialogHeight,this.thisNode=b,this.title=b.getTitle()+(a.readOnly?" (Read only)":""),this.buttons={},a.readOnly?this.buttons.Close=GeoFlowEditor.NodeDialogParam.onClose:(this.buttons.Ok=GeoFlowEditor.NodeDialogParam.onOk,this.buttons.Cancel=GeoFlowEditor.NodeDialogParam.onCancel,this.buttons.Apply=GeoFlowEditor.NodeDialogParam.onApply)},GeoFlowEditor.NodeDialogParam.prototype.updateDlg=function(){this.dlgDIV.innerHTML=this.content},GeoFlowEditor.NodeDialogParam.prototype.showDlg=function(){$(this.dlgSelector).dialog(this);var a=__get_elem(GeoFlowEditor.__divNodeState);if(__not_null(a)){var b=__get_elem(GeoFlowEditor.__serviceURLs);if(__not_null(b))if(__not_null(b.options)){for(var c=0;c<b.options.length;c++)if(b.options[c].text==this.thisNode.serviceName){b.selectedIndex=c,a.innerHTML=this.thisNode.getServiceState();break}}else b.value==this.thisNode.serviceName&&(a.innerHTML=this.thisNode.getServiceState())}this.disableButton("Ok","Apply","Cancel")},GeoFlowEditor.NodeDialogParam.prototype.disableButton=function(){var a=Array.prototype.slice.call(arguments);a.length!==0&&$(this.dlgSelector).parent().find("button").each(function(){for(var b=$(this).text(),c=0;c<a.length;c++)a[c]==b&&$(this).attr("disabled",!0).addClass("ui-button-disabled")})},GeoFlowEditor.NodeDialogParam.prototype.enableButton=function(){var a=Array.prototype.slice.call(arguments);a.length!==0&&$(this.dlgSelector).parent().find("button").each(function(){for(var b=$(this).text(),c=0;c<a.length;c++)a[c]==b&&$(this).attr("disabled",!1).removeClass("ui-button-disabled")})},GeoFlowEditor.NodeDialogParam.prototype.isButtonDisabled=function(a){return!1},GeoFlowEditor.NodeDialogParam.prototype.setButtons=function(a,b,c){this.buttons={},a===1&&(this.buttons.Ok=GeoFlowEditor.NodeDialogParam.onOk),b===1&&(this.buttons.Cancel=GeoFlowEditor.NodeDialogParam.onCancel),c===1&&(this.buttons.Apply=GeoFlowEditor.NodeDialogParam.onApply)},GeoFlowEditor.NodeDialogParam.onClose=function(){$(this).dialog("close")},GeoFlowEditor.NodeDialogParam.onOk=function(){dlgParam.isButtonDisabled("Apply")||GeoFlowEditor.NodeDialogParam.onApply(),$(this).dialog("close")},GeoFlowEditor.NodeDialogParam.onCancel=function(){$(this).dialog("close")},GeoFlowEditor.NodeDialogParam.onApply=function(){try{GeoFlowEditor.instance.updateNode(dlgParam.thisNode,dlgParam.nodeJSON,dlgParam.nodeURL);var a=__get_elem(GeoFlowEditor.__divNodeState);dlgParam.thisNode.setServiceState(a.name,a.innerHTML),dlgParam.disableButton("Apply"),$(dlgParam.dlgSelector).dialog("option","title",dlgParam.thisNode.getTitle())}catch(b){__log("GeoFlowEditor.NodeDialogParam.onApply exception: ",b.message)}},GeoFlowEditor.nodeDialog=GeoFlowEditor.instance=null,GeoFlowEditor.getParamsHTML=function(a,b){for(var c="",d=0;d<a.length;d++){var e=a[d];e.direction===b&&(c+="<br/><span style='margin-left:20px; font-size:9pt'><b>"+e.displayName+"</b></span><ul style='padding-left:40px; list-style-type:circle; width:auto; min-height:0; margin:0;'><li style='margin-left:0px; font-size:8pt; list-style-type:inherit; width:auto;'>"+e.dataType+"</li><li style='margin-left:0px; font-size:8pt; list-style-type:inherit; width:auto;'>"+e.parameterType+"</li>",__not_null(e.description)&&(c+="<li style='margin-left:0px; font-size:8pt; list-style-type:inherit; width:auto;'>"+e.description+"</li>"),c+="</ul>")}return c},GeoFlowEditor.getNodeHTML=function(a,b){var c="<p><a href='javascript:void(0);' onclick='window.open(\""+a+"\");return false;'><span style='color:green;margin-left:0px;font-size:11pt;'><strong>"+b.displayName+"</strong></span></a></p>";__not_null(b.description)&&(c+="<ul style='padding-left:40px; list-style-type:circle; width:auto; min-height:0; margin:0;'><li style='margin-left:0px; font-size:8pt; list-style-type:inherit; width:auto;'>"+b.description+"</li></ul>");return c+="<p/><strong>Input Parameters:</strong></p>"+GeoFlowEditor.getParamsHTML(b.parameters,"esriGPParameterDirectionInput")+"<p/><strong>Output Parameters:</strong></p>"+GeoFlowEditor.getParamsHTML(b.parameters,"esriGPParameterDirectionOutput")+"<p/><p><a href='javascript:void(0);' onclick='window.open(\""+b.helpUrl+"\");return false;'><span style='color:green;margin-left:0px;font-size:11pt'><strong>Help</strong></span></a></p>"},GeoFlowEditor.ajaxGetNodeJSON=function(a,b,c){$.ajax({url:b,dataType:"jsonp",timeout:6e3,data:{f:"json",pretty:"true"},success:function(d){dlgParam.nodeJSON=d,dlgParam.nodeURL=b,c.name=a,c.innerHTML=GeoFlowEditor.getNodeHTML(b,d),dlgParam.enableButton("Ok","Cancel","Apply")},error:function(d){var e="<h3>Error to get URL:<h3><p><a href='"+b+"'>"+b+"</a></p>";e+="<p>"+d.statusText+"</p>",c.name=a,c.innerHTML=e}})},GeoFlowEditor.refreshNodeURL=function(a,b,c){var d=__get_elem(b),e=__get_elem(c),f;switch(a){case esri2.GeoFlow.NodeTypes.NodeGpSync:case esri2.GeoFlow.NodeTypes.NodeGpAsync:f=d.options[d.selectedIndex],GeoFlowEditor.ajaxGetNodeJSON(f.text,f.value,e);break;case esri2.GeoFlow.NodeTypes.NodePubInput:case esri2.GeoFlow.NodeTypes.NodePubOutput:break;case esri2.GeoFlow.NodeTypes.NodeGeometry:f=d.options[d.selectedIndex],dlgParam.nodeJSON=esri2.GeoFlow.Node.Geometry.operations[f.value],dlgParam.nodeURL=dlgParam.nodeJSON.url+"/"+dlgParam.nodeJSON.name,e.name=f.text,e.innerHTML=GeoFlowEditor.getNodeHTML(dlgParam.nodeURL,dlgParam.nodeJSON),dlgParam.enableButton("Ok","Cancel","Apply");break;case esri2.GeoFlow.NodeTypes.NodeFeature:var g=d.value;$.ajax({url:g,dataType:"jsonp",timeout:6e3,data:{f:"json",pretty:"true"},success:function(a){dlgParam.nodeURL=g;for(var b=esri2.GeoFlow.Node.Feature.operations.query,c=0;c<b.parameters.length;c++)if(b.parameters[c].name==="inSR"||b.parameters[c].name==="outSR")try{b.parameters[c].defaultValue='"'+a.extent.spatialReference.wkid+'"'}catch(d){b.parameters[c].defaultValue='""'}b.name=a.name,b.displayName=a.type+": "+b.name,dlgParam.nodeJSON=b,e.name=dlgParam.nodeJSON.url=g,e.innerHTML=GeoFlowEditor.getNodeHTML(dlgParam.nodeURL,dlgParam.nodeJSON),dlgParam.enableButton("Ok","Cancel","Apply")},error:function(a){var b="<h3>Error to get:<h3><p><a href='"+g+"'>"+g+"</a></p>";b+="<p>"+a.statusText+"</p>",e.name=g,e.innerHTML=b}})}},GeoFlowEditor.getNodeStatusHTML=function(a){var b="";a.isDefaultStatus()||(b="<div style='padding-left:10px; border:3px solid "+a.getStatusColor()+";'>JobStatus: "+a.execStatus+"<br />Message: "+a.errMessage+"</div>");return b},GeoFlowEditor.getGpSyncDlgContent=function(a){var b=GeoFlowEditor.GPServicesList[esri2.GeoFlow.NodeTypes.NodeGpSync];if(__is_null(b))throw new Error("GeoFlowEditor.GPServicesList: GpSync not found");var c,d,e;for(e="<p>service URL:<select id='__serviceURLs'>",c=0;c<b.length;c++)d=b[c],e+="<option value='"+d.url+"'>"+d.name+"</option>";return e+="</select><input type='button' value='select' onclick='GeoFlowEditor.refreshNodeURL(\""+esri2.GeoFlow.NodeTypes.NodeGpSync+'", "__serviceURLs", "__divNodeState");\' /></p>'+GeoFlowEditor.getNodeStatusHTML(a)+"<p><div id='__divNodeState'></p>"},GeoFlowEditor.getGpAsyncDlgContent=function(a){var b=GeoFlowEditor.GPServicesList[esri2.GeoFlow.NodeTypes.NodeGpAsync];if(__is_null(b))throw new Error("GeoFlowEditor.GPServicesList: GpAsync not found");var c,d,e;for(e="<p>service URL:<select id='__serviceURLs'>",c=0;c<b.length;c++)d=b[c],e+="<option value='"+d.url+"'>"+d.name+"</option>";return e+="</select><input type='button' value='select' onclick='GeoFlowEditor.refreshNodeURL(\""+esri2.GeoFlow.NodeTypes.NodeGpAsync+'", "__serviceURLs", "__divNodeState");\' /></p>'+GeoFlowEditor.getNodeStatusHTML(a)+"<p><div id='__divNodeState'></p>"},GeoFlowEditor.getPubInputDlgContent=function(a){var b=a.getOutPort(1),c=GeoFlowEditor.getNodeStatusHTML(a)+"<table><tr><td>Input Name:</td><td>"+a.name+"</td></tr><tr><td>Data Type:</td><td>"+b.dataType+"</td></tr><tr><td>Default Value:</td><td>"+b.defaultValue+"</td></tr></table>";return c},GeoFlowEditor.getPubOutputDlgContent=function(a){var b=a.getInPort(1),c=GeoFlowEditor.getNodeStatusHTML(a)+"<table><tr><td>Output Name:</td><td>"+a.name+"</td></tr><tr><td>Data Type:</td><td>"+b.dataType+"</td></tr><tr><td>Default Value:</td><td>"+b.defaultValue+"</td></tr><tr><td>Callout URL:</td><td><input id='__calloutURL' type='text' size='40' maxlength='1200' value='"+a.typedNode.callout+"' oninput='GeoFlowEditor.checkInputValue(\""+esri2.GeoFlow.NodeTypes.NodePubOutput+'", "__calloutURL");\' /></td></tr></table>';return c},GeoFlowEditor.getGeometryDlgContent=function(a){var b,c,d,e,f,g=esri2.GeoFlow.Node.Geometry.operations;d="<p>service URL:<select id='__serviceURLs'>";for(e in g)f=g[e],f.enabled&&(d+="<option value='"+e+"'>"+f.displayName+"</option>");d+="</select>";return d+="<input type='button' value='select' onclick='GeoFlowEditor.refreshNodeURL(\""+esri2.GeoFlow.NodeTypes.NodeGeometry+'", "__serviceURLs", "__divNodeState");\' /></p>'+GeoFlowEditor.getNodeStatusHTML(a)+"<p><div id='__divNodeState'></p>"},GeoFlowEditor.getFeatureDlgContent=function(a){var b;return b="<p><input id='__serviceURLs' type='text' size='60' maxlength='1200' value='"+a.url+"'/><input type='button' value='select' onclick='GeoFlowEditor.refreshNodeURL(\""+esri2.GeoFlow.NodeTypes.NodeFeature+'", "__serviceURLs", "__divNodeState");\' /></p>'+GeoFlowEditor.getNodeStatusHTML(a)+"<p><div id='__divNodeState'></p>"},GeoFlowEditor.getDispatchDlgContent=function(a){var b,c="";c+="<p><span style='color:green;margin-left:0px;font-size:11pt;'><strong>"+a.displayName+"</strong></span></p>"+GeoFlowEditor.getNodeStatusHTML(a)+"<p/><strong>Inputs:</strong></p>";var d=a.getInPort();for(b=1;b<=d;b++){var e=a.getInPort(b);b!==1&&(c+="<br/>"),c+="<span style='margin-left:20px; font-size:9pt'><b>"+e.displayName+"</b></span>";var f=e.getLinkedPort();__not_null(f)&&(c+="<span style='margin-left:20px; font-size:9pt'>("+f.parentNode.getTitle()+")</span>"),c+="<br/><span style='margin-left:40px; font-size:9pt'>"+e.dataType+"</span>"}c+="<p/><strong>Outputs:</strong></p>";var g=a.getOutPort();for(b=1;b<g;b++){var h=a.getOutPort(b);b!==1&&(c+="<br/>"),c+="<span style='margin-left:20px; font-size:9pt'><b>"+h.displayName+"</b></span>";var i=h.getLinkedPort();__not_null(i)&&(c+="<span style='margin-left:20px; font-size:9pt'>("+i.parentNode.getTitle()+")</span>"),c+="<br/><span style='margin-left:40px; font-size:9pt'>"+h.dataType+"</span>"}return c},GeoFlowEditor.getDefaultValDlgContent=function(a){var b="";b+=GeoFlowEditor.getNodeStatusHTML(a)+"<table>";for(var c=a.getOutPort(),d=1;d<c;d++){var e=a.getOutPort(d);b+="<tr><td>"+e.displayName+":</td><td><textarea rows='3' cols='40' style='resize:none;' id='"+e.name+"' oninput='GeoFlowEditor.checkInputValue(\""+esri2.GeoFlow.NodeTypes.NodeDefaultVal+'","'+e.name+"\");'>"+e.defaultValue+"</textarea></td><td>("+e.dataType+")</td></tr>"}b+="</table>",c===1&&(b="<p>No link found with this node</p>");return b},GeoFlowEditor.getAssignmentDlgContent=function(a){var b;return b="<p>Description:</p>"+GeoFlowEditor.getNodeStatusHTML(a)+"<p><input id='assignment_desc' type='text' size='60' "+(GeoFlowEditor.instance.readOnly?"readonly='true' ":" ")+"maxlength='1200' value='"+a.typedNode.description+"' oninput='GeoFlowEditor.checkInputValue(\""+esri2.GeoFlow.NodeTypes.NodeAssignment+'", "assignment_desc");\' /></p>'},GeoFlowEditor.checkInputValue=function(a,b){var c=__get_elem(b);__log(c.value),a===esri2.GeoFlow.NodeTypes.NodeAssignment?(dlgParam.thisNode.setServiceState(b,c.value),dlgParam.enableButton("Ok","Cancel","Apply")):a===esri2.GeoFlow.NodeTypes.NodeDefaultVal?dlgParam.enableButton("Ok","Cancel","Apply"):a===esri2.GeoFlow.NodeTypes.NodePubOutput&&dlgParam.enableButton("Ok","Cancel")},GeoFlowEditor.updateNodeAssignment=function(a){a.typedNode.description=a.getServiceState()},GeoFlowEditor.updateNodeDefaultVal=function(a){for(var b=a.getOutPort(),c=1;c<b;c++)port=a.getOutPort(c),port.defaultValue=__get_elem(port.name).value,__log(port.name+" = "+port.defaultValue),a.typedNode.updateOutPort(port.getNextLink())},GeoFlowEditor.updateNodePubOutput=function(a){a.typedNode.setCallout(__get_elem("__calloutURL").value)},GeoFlowEditor.updateNodePubInput=function(a){};;